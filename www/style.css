:root{
  --gradient-start: #0a0514;
  --gradient-end: #1a0f2e;
  --neon: #2af5d2;
  --neon-pink: #ff2e97;
  --neon-purple: #a855f7;
  --ok: #8fd4ff;
  --good: #73ffa9;
  --perfect: #fff7a1;
  --warn: #ff6b6b;
  --glass: rgba(20, 15, 35, 0.65);
  --glass-border: rgba(255, 255, 255, 0.08);
  --sat: env(safe-area-inset-top, 0px);
  --sab: env(safe-area-inset-bottom, 0px);
  --vh: 1vh;
  --font: "Oxanium", ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial;
  --ring-1: #0fe7c4;
  --ring-2: #2af5d2;
  --ring-3: #63ffe3;
  --ring-4: #d7fff7;
  --brand-red: #FF3366;
}

/* Base */
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
html, body { 
  height: 100%; 
  font-family: var(--font);
  background: linear-gradient(135deg, var(--gradient-start) 0%, var(--gradient-end) 100%);
  color: #e0f2f1; 
  font-size: 16px; 
  overscroll-behavior: none; 
  -webkit-user-select: none; 
  user-select: none; 
  -webkit-touch-callout: none;
  position: relative;
  overflow: hidden;
}

/* Animated background particles */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background: 
    radial-gradient(circle at 20% 30%, rgba(42, 245, 210, 0.08) 0%, transparent 50%),
    radial-gradient(circle at 80% 70%, rgba(168, 85, 247, 0.06) 0%, transparent 50%);
  animation: bgPulse 8s ease-in-out infinite;
  pointer-events: none;
}

@keyframes bgPulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}

canvas { 
  display: block; 
  width: 100vw; 
  height: calc(var(--vh, 1dvh) * 100); 
  touch-action: manipulation;
  position: relative;
  z-index: 1;
}

/* HUD */
.hud { 
  position: fixed; 
  inset: 0; 
  pointer-events: none; 
  display: flex; 
  flex-direction: column; 
  justify-content: space-between; 
  padding: calc(max(16px, var(--sat)) + 8px) clamp(16px, 4vw, 24px) calc(max(16px, var(--sab)) + 12px);
  z-index: 10;
}

/* Hide top score/best pills on the menu and in-game */
#topRow {
  display: none !important;
}

.row { 
  display: flex; 
  justify-content: space-between; 
  gap: 12px; 
  font-weight: 600; 
  letter-spacing: 0.3px;
}

.pill { 
  background: var(--glass);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
  padding: 10px 16px;
  backdrop-filter: blur(16px) saturate(180%);
  -webkit-backdrop-filter: blur(16px) saturate(180%);
  font-weight: 700;
  letter-spacing: 0.4px;
  pointer-events: auto;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.pill-stack { 
  display: flex; 
  flex-direction: column; 
  align-items: center; 
  justify-content: center; 
  flex: 1; 
  min-width: 0; 
  padding: 12px 14px;
  line-height: 1.1;
  text-align: center;
}

.pill-label { 
  font-size: clamp(11px, 2.8vmin, 13px);
  opacity: 0.75;
  line-height: 1.1;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.pill-value { 
  font-size: clamp(22px, 5.5vmin, 32px);
  font-weight: 800;
  line-height: 1;
  font-variant-numeric: tabular-nums;
  background: linear-gradient(135deg, var(--neon) 0%, #fff 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-top: 4px;
}

/* Score flash animation */
@keyframes scoreFlash {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.15); }
}

.pill-value.flash {
  animation: scoreFlash 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes hudGlow {
  0%, 100% { 
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    border-color: var(--glass-border);
  }
  50% { 
    box-shadow: 0 0 40px rgba(42, 245, 210, 0.4), 0 8px 32px rgba(0, 0, 0, 0.3);
    border-color: rgba(42, 245, 210, 0.4);
  }
}

#topRow.blink .pill { 
  animation: hudGlow 0.6s ease-in-out 3;
}

/* Center text */
.center { 
  position: fixed; 
  left: 50%; 
  top: 50%; 
  transform: translate(-50%, -50%); 
  text-align: center; 
  pointer-events: none;
  z-index: 5;
}

.logo { 
  display: block; 
  margin: 0 auto 16px; 
  width: min(100px, 26vw); 
  max-height: 20vh; 
  object-fit: contain;
  filter: drop-shadow(0 0 24px rgba(42, 245, 210, 0.35));
  animation: logoFloat 3s ease-in-out infinite;
}

@keyframes logoFloat {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-8px); }
}

.title-stack { 
  display: inline-block; 
  line-height: 0.9;
  font-weight: 800;
  letter-spacing: 1px;
  text-transform: uppercase;
}

.title-loading, .title-rush {
  display: block;
  font-size: clamp(28px, 8vmin, 48px);
  background: linear-gradient(
    135deg,
    var(--ring-1) 0%,
    var(--ring-2) 30%,
    var(--ring-3) 65%,
    var(--ring-4) 100%
  );
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 0 0 40px rgba(42, 245, 210, 0.35);
}

.big { 
  font-size: clamp(24px, 6vmin, 36px);
  line-height: 1.2;
  letter-spacing: 0.5px;
  font-weight: 800;
  text-shadow: 0 0 30px rgba(255, 107, 107, 0.5);
  color: var(--warn);
}

/* Mode Selector */
.mode-selector {
  display: flex;
  flex-direction: column;
  gap: 12px;
   margin-top: clamp(260px, 40vh, 440px);
  pointer-events: auto;
  opacity: 1;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.mode-selector.hide {
  opacity: 0;
  transform: translateY(-10px);
  pointer-events: none;
}

.mode-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 16px 24px;
  border-radius: 16px;
  font-weight: 800;
  font-size: clamp(16px, 4vmin, 20px);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border: 2px solid transparent;
  cursor: pointer;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  min-width: 280px;
}

#normalModeBtn {
  flex-direction: row;   /* ikonka vedle textu */
}

.mode-btn-header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
}

.mode-btn-icon {
  font-size: clamp(24px, 6vmin, 32px);
}

.mode-btn-label {
  line-height: 1;
}

.mode-btn-info {
  display: flex;
  flex-direction: column;
  gap: 4px;
  font-size: clamp(11px, 2.8vmin, 13px);
  font-weight: 600;
  text-transform: none;
  letter-spacing: 0.3px;
  margin-top: 4px;
}

.daily-info-row {
  display: flex;
  justify-content: space-between;
  gap: 16px;
}

.daily-reset {
  font-size: clamp(10px, 2.4vmin, 12px);
  opacity: 0.85;
}

.mode-btn-normal {
  background: linear-gradient(135deg, var(--neon) 0%, #1de9bf 100%);
  color: #001a14;
  box-shadow: 0 0 30px rgba(42, 245, 210, 0.4), 0 8px 24px rgba(0, 0, 0, 0.3);
}

.mode-btn-normal:hover {
  transform: scale(1.05);
  box-shadow: 0 0 40px rgba(42, 245, 210, 0.6), 0 12px 32px rgba(0, 0, 0, 0.4);
}

.mode-btn-normal:active {
  transform: scale(0.98);
}

.mode-btn-daily {
  background: linear-gradient(135deg, var(--neon-pink) 0%, var(--neon-purple) 100%);
  color: #ffffff;
  box-shadow: 0 0 30px rgba(255, 46, 151, 0.4), 0 8px 24px rgba(0, 0, 0, 0.3);
}

.mode-btn-daily:hover {
  transform: scale(1.05);
  box-shadow: 0 0 40px rgba(255, 46, 151, 0.6), 0 12px 32px rgba(0, 0, 0, 0.4);
}

.mode-btn-daily:active {
  transform: scale(0.98);
}

/* Mode Badge (during gameplay) */
.mode-badge {
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  top: calc(18vh + var(--sat));
  z-index: 15;
  pointer-events: none;
  background: linear-gradient(135deg, rgba(255, 46, 151, 0.2) 0%, rgba(168, 85, 247, 0.2) 100%);
  border: 2px solid var(--neon-pink);
  border-radius: 50px;
  padding: 8px 20px;
  font-weight: 800;
  letter-spacing: 0.5px;
  font-size: clamp(12px, 3vmin, 14px);
  text-transform: uppercase;
  color: #fff;
  box-shadow: 0 0 30px rgba(255, 46, 151, 0.4), 0 8px 24px rgba(0, 0, 0, 0.3);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  animation: modeBadgePulse 2s ease-in-out infinite;
}

@keyframes modeBadgePulse {
  0%, 100% {
    box-shadow: 0 0 30px rgba(255, 46, 151, 0.4), 0 8px 24px rgba(0, 0, 0, 0.3);
  }
  50% {
    box-shadow: 0 0 50px rgba(255, 46, 151, 0.7), 0 8px 24px rgba(0, 0, 0, 0.3);
  }
}

/* How to play bubble */
.howto { 
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  top: calc(16vh + var(--sat));
  width: clamp(240px, 65vw, 300px);
  z-index: 15;
  pointer-events: none;
  background: var(--glass);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
  padding: 16px 18px;
  text-align: center;
  box-shadow: 0 16px 48px rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  opacity: 1;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.howto.hide { 
  opacity: 0;
  transform: translateX(-50%) translateY(-20px);
}

.howto-title { 
  font-weight: 800;
  letter-spacing: 0.5px;
  margin-bottom: 8px;
  font-size: clamp(13px, 3.2vmin, 15px);
  opacity: 0.95;
  text-transform: uppercase;
  color: var(--neon);
}

.howto-body { 
  font-size: clamp(14px, 3.4vmin, 16px);
  line-height: 1.5;
  opacity: 0.9;
}

.icon-tri { 
  display: inline-block;
  width: 1.3em;
  height: 1.8em;
  vertical-align: -0.45em;
  margin: 0 0.1em;
}

.icon-tri svg { 
  display: block;
  width: 100%;
  height: 100%;
  fill: var(--neon);
  filter: drop-shadow(0 0 8px rgba(42, 245, 210, 0.6));
}

/* Scoring guide */
.score-guide {
  font-size: clamp(11px, 2.6vmin, 13px);
  opacity: 0.7;
  text-align: center;
  letter-spacing: 0.3px;
  background: var(--glass);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
  padding: 8px 16px;
  backdrop-filter: blur(16px) saturate(180%);
  -webkit-backdrop-filter: blur(16px) saturate(180%);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  pointer-events: auto;
}

/* Slow Motion Badge */
.slow-badge { 
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  top: calc(50% + 140px);
  z-index: 20;
  pointer-events: auto;
  cursor: pointer;
  background: linear-gradient(135deg, rgba(42, 245, 210, 0.15) 0%, rgba(168, 85, 247, 0.15) 100%);
  border: 2px solid var(--neon);
  border-radius: 50px;
  padding: 14px 28px;
  font-weight: 800;
  letter-spacing: 0.5px;
  font-size: clamp(14px, 3.6vmin, 17px);
  text-transform: uppercase;
  color: var(--neon);
  box-shadow: 0 0 40px rgba(42, 245, 210, 0.4), 0 8px 32px rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  display: none;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  animation: badgePulse 2s ease-in-out infinite;
}

@keyframes badgePulse {
  0%, 100% { 
    box-shadow: 0 0 40px rgba(42, 245, 210, 0.4), 0 8px 32px rgba(0, 0, 0, 0.4);
  }
  50% { 
    box-shadow: 0 0 60px rgba(42, 245, 210, 0.7), 0 8px 32px rgba(0, 0, 0, 0.4);
  }
}

.slow-badge.show { 
  display: inline-block;
}

.slow-badge:hover {
  transform: translateX(-50%) scale(1.05);
  box-shadow: 0 0 60px rgba(42, 245, 210, 0.7), 0 12px 40px rgba(0, 0, 0, 0.5);
}

.slow-badge:active {
  transform: translateX(-50%) scale(0.95);
}

/* HUD visibility */
#topRow, .score-guide, .slow-badge { 
  transition: opacity 0.25s ease, transform 0.25s ease;
}

body.hud-hidden #topRow, 
body.hud-hidden .score-guide { 
  opacity: 0;
  pointer-events: none;
}

body.hud-hidden .slow-badge { 
  opacity: 0;
  pointer-events: none;
}

body.hud-hidden .slow-badge.show { 
  opacity: 1;
  pointer-events: auto;
}

/* Buttons */
.btn { 
  display: block;
  width: 100%;
  text-align: center;
  padding: 16px 20px;
  border-radius: 16px;
  font-weight: 800;
  letter-spacing: 0.5px;
  cursor: pointer;
  font-size: clamp(15px, 3.8vmin, 18px);
  line-height: 1.3;
  border: none;
  min-height: 54px;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  text-transform: uppercase;
  position: relative;
  overflow: hidden;
}

.btn::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 100%);
  opacity: 0;
  transition: opacity 0.25s ease;
}

.btn:hover::before {
  opacity: 1;
}

.btn:active { 
  transform: scale(0.97);
}

.btn-primary { 
  background: linear-gradient(135deg, var(--neon) 0%, #1de9bf 100%);
  color: #001a14;
  box-shadow: 0 0 30px rgba(42, 245, 210, 0.4), 0 8px 24px rgba(0, 0, 0, 0.3);
}

.btn-primary:hover {
  box-shadow: 0 0 40px rgba(42, 245, 210, 0.6), 0 12px 32px rgba(0, 0, 0, 0.4);
}

.btn-secondary { 
  background: var(--glass);
  color: #b8d4d0;
  border: 1px solid var(--glass-border);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
  backdrop-filter: blur(16px) saturate(180%);
  -webkit-backdrop-filter: blur(16px) saturate(180%);
  font-size: clamp(13px, 3.4vmin, 16px);
  opacity: 0.85;
}

.btn-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

/* Modal */
.modal { 
  position: fixed;
  inset: 0;
  z-index: 100;
  display: none;
  align-items: center;
  justify-content: center;
}

.modal.open { 
  display: flex;
}

.modal-overlay { 
  position: absolute;
  inset: 0;
  background: rgba(5, 3, 10, 0.85);
  backdrop-filter: blur(8px) saturate(180%);
  -webkit-backdrop-filter: blur(8px) saturate(180%);
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.modal-card { 
  position: relative;
  width: min(94vw, 420px);
  max-height: 90vh;
  overflow-y: auto;
  background: linear-gradient(135deg, rgba(20, 15, 35, 0.95) 0%, rgba(30, 20, 50, 0.95) 100%);
  border: 1px solid var(--glass-border);
  border-radius: 28px;
  box-shadow: 0 24px 80px rgba(0, 0, 0, 0.6);
  padding: 28px 24px calc(28px + var(--sab));
  animation: modalSlideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  backdrop-filter: blur(40px) saturate(180%);
  -webkit-backdrop-filter: blur(40px) saturate(180%);
}

@keyframes modalSlideUp {
  from { 
    opacity: 0;
    transform: translateY(40px) scale(0.95);
  }
  to { 
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.modal-header { 
  display: flex;
  gap: 16px;
  justify-content: space-between;
  margin-bottom: 20px;
}

.stat { 
  flex: 1;
  text-align: center;
  background: var(--glass);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
  padding: 16px 12px;
  backdrop-filter: blur(16px) saturate(180%);
  -webkit-backdrop-filter: blur(16px) saturate(180%);
}

.stat .label { 
  font-size: clamp(11px, 2.8vmin, 13px);
  opacity: 0.75;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 6px;
}

.stat .value { 
  font-size: clamp(28px, 6.5vmin, 40px);
  font-weight: 800;
  letter-spacing: 0.3px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  line-height: 1;
  background: linear-gradient(135deg, var(--neon) 0%, #fff 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.chip { 
  display: inline-block;
  font-size: clamp(9px, 2.2vmin, 11px);
  font-weight: 800;
  color: #001a14;
  background: linear-gradient(135deg, var(--perfect) 0%, #ffe680 100%);
  padding: 4px 10px;
  border-radius: 20px;
  box-shadow: 0 0 20px rgba(255, 247, 161, 0.4);
  text-transform: uppercase;
  letter-spacing: 0.3px;
}

/* Daily Goal Status */
.daily-goal-status {
  background: var(--glass);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
  padding: 14px 16px;
  margin-bottom: 16px;
  text-align: center;
  backdrop-filter: blur(16px) saturate(180%);
  -webkit-backdrop-filter: blur(16px) saturate(180%);
}

.goal-status-text {
  font-size: clamp(13px, 3.2vmin, 15px);
  font-weight: 700;
  letter-spacing: 0.3px;
  margin-bottom: 6px;
}

.goal-status-text.completed {
  color: var(--perfect);
}

.goal-status-text.not-reached {
  color: rgba(255, 255, 255, 0.7);
}

.goal-reset-text {
  font-size: clamp(11px, 2.6vmin, 13px);
  opacity: 0.7;
  letter-spacing: 0.3px;
}

.modal-actions { 
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin: 20px 0;
}

.modal-actions-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}

.subline { 
  font-size: clamp(11px, 2.6vmin, 13px);
  opacity: 0.75;
  text-align: center;
  margin-top: -4px;
  letter-spacing: 0.3px;
}

/* Patreon Section */
.modal-patreon { 
  margin-top: 24px;
  padding-top: 24px;
  border-top: 1px solid var(--glass-border);
  text-align: center;
}

.patreon-hook { 
  font-size: clamp(14px, 4vmin, 16px);
  font-weight: 700;
  margin-bottom: 16px;
  background: linear-gradient(135deg, var(--neon-pink) 0%, var(--neon-purple) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  line-height: 1.3;
}

.patreon-cta {
  display: inline-block;
  padding: 16px 32px;
  background: linear-gradient(135deg, var(--neon-pink) 0%, var(--neon-purple) 100%);
  color: #fff;
  text-decoration: none;
  border-radius: 16px;
  font-weight: 800;
  font-size: clamp(14px, 3.6vmin, 17px);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  box-shadow: 0 0 30px rgba(255, 46, 151, 0.4), 0 8px 24px rgba(0, 0, 0, 0.3);
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  margin-bottom: 12px;
}

.patreon-cta:hover {
  transform: scale(1.05);
  box-shadow: 0 0 40px rgba(255, 46, 151, 0.6), 0 12px 32px rgba(0, 0, 0, 0.4);
}

.patreon-cta:active {
  transform: scale(0.98);
}

.patreon-micro { 
  font-size: clamp(11px, 2.6vmin, 13px);
  opacity: 0.7;
  margin-top: 12px;
  line-height: 1.4;
}

/* Back to Menu */
.modal-back {
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid var(--glass-border);
  text-align: center;
}

.back-link {
  color: rgba(255, 255, 255, 0.6);
  text-decoration: underline;
  font-size: clamp(12px, 3vmin, 14px);
  font-weight: 600;
  letter-spacing: 0.3px;
  transition: color 0.2s ease;
}

.back-link:hover {
  color: rgba(255, 255, 255, 0.9);
}

/* Toast */
.toast { 
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  bottom: calc(24px + var(--sab));
  background: var(--glass);}

  /* Titulek do středu kruhu + logo nad něj */
.center { /* už máš fixed + translate, to necháme */
  position: fixed;
}

/* --- Title do středu kruhu --- */
.big {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%); 
  margin: 0;
  pointer-events: none;
}

/* --- Logo přesně na střed a o kus výš nad nápis --- */
#logo {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: clamp(70px, 18vmin, 110px);
  margin-top: -55px;
  height: auto;
  pointer-events: none;
  animation: none; 
}

/* --- Tlačítka zase pod kruh (přidáme offset) --- */
.mode-selector {
  margin-top: calc(clamp(260px, 40vh, 440px) + 100px);
  /* pokud budou pořád moc vysoko/nízko, uprav jen +100px (např. +120px) */
}

